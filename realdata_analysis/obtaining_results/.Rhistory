#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+ scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+ scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
plot(g)
g <- g + guides(color = guide_legend(nrow=1))
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
g <- g + guides(fill = guide_legend(nrow=1))
plot(g)
# pickrell
main = "Lymphoblastoid cell lines (Female vs. Male)"
disDEG_ori_all <- readRDS("/Users/manon/Desktop/リアルデータ解析/Pickrell/original_analysis/discoveryDEG_ori_Ntri10_p.obj")
disDEG_per <- readRDS("~/Desktop/リアルデータ解析/Pickrell/permuted_analysis/discoveryDEG_per.obj")
nDEG_per <- read.table("~/Desktop/リアルデータ解析/Pickrell/permuted_analysis/nDEG_permuted.txt",sep = "\t",header = T)
# ある1試行の検出DEG数をデータフレームにまとめる
disDEG_ori <- disDEG_ori_all[[6]] #データ順に1,9,6,1行目
nDEG_ori <- data.frame(edgeR = length(disDEG_ori$edgeR),
DESeq2 = length(disDEG_ori$DESeq2),
TCC = length(disDEG_ori$TCC),
MBCdeg1_K2 = length(disDEG_ori$MBCdeg1$K2),
MBCdeg1_K3 = length(disDEG_ori$MBCdeg1$K3),
MBCdeg1_K4 = length(disDEG_ori$MBCdeg1$K4),
MBCdeg1_K5 = length(disDEG_ori$MBCdeg1$K5),
MBCdeg2_K2 = length(disDEG_ori$MBCdeg2$K2),
MBCdeg2_K3 = length(disDEG_ori$MBCdeg2$K3),
MBCdeg2_K4 = length(disDEG_ori$MBCdeg2$K4),
MBCdeg2_K5 = length(disDEG_ori$MBCdeg2$K5),
MBCdeg3_K2 = length(disDEG_ori$MBCdeg3$K2),
MBCdeg3_K3 = length(disDEG_ori$MBCdeg3$K3),
MBCdeg3_K4 = length(disDEG_ori$MBCdeg3$K4),
MBCdeg3_K5 = length(disDEG_ori$MBCdeg3$K5))
max(nDEG_ori)
#-----------------------------------------------
# Fig. A2 オリジナルデータ(K=3)でのDEG検出数
#-----------------------------------------------
nDEG_ori_k3 <- data.frame(edgeR = nDEG_ori$edgeR,
DESeq2 = nDEG_ori$DESeq2,
TCC = nDEG_ori$TCC,
MBCdeg1 = nDEG_ori$MBCdeg1_K3,
MBCdeg2 = nDEG_ori$MBCdeg2_K3,
MBCdeg3 = nDEG_ori$MBCdeg3_K3)
deg_list <- NULL
dist <- list()
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$edgeR)
}
dist$edgeR <- table(table(deg_list))
deg_edger <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$DESeq2)
}
dist$DESeq2 <- table(table(deg_list))
deg_deseq2 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$TCC)
}
dist$TCC <- table(table(deg_list))
deg_tcc <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg1$K3)
}
dist$MBCdeg1 <- table(table(deg_list))
deg_mbcdeg1 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg2$K3)
}
dist$MBCdeg2 <- table(table(deg_list))
deg_mbcdeg2 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg3$K3)
}
dist$MBCdeg3 <- table(table(deg_list))
deg_mbcdeg3 <- deg_list
# 確認
dist
df_edgeR <- df_DESeq2 <- df_TCC <- df_MBCdeg1 <- df_MBCdeg2 <- df_MBCdeg3 <-data.frame(x = paste(1:100),
y = rep(0,100))
str(disDEG_ori)
### オリジナルデータセットと並べ替えデータセットで共通して検出されたDEGのリスト
common_edger <- NULL   # 共通検出DEGの数(K=3)
common_deseq2 <- NULL
common_tcc <- NULL
common_mbcdeg1 <- NULL
common_mbcdeg2 <- NULL
common_mbcdeg3 <- NULL
for (i in 1:100){
common_edger <- c(common_edger,length(intersect(disDEG_ori$edgeR,disDEG_per[[i]]$edgeR)))
common_deseq2 <- c(common_deseq2,length(intersect(disDEG_ori$DESeq2,disDEG_per[[i]]$DESeq2)))
common_tcc <- c(common_tcc,length(intersect(disDEG_ori$TCC,disDEG_per[[i]]$TCC)))
common_mbcdeg1 <- c(common_mbcdeg1,length(intersect(disDEG_ori$MBCdeg1$K3,disDEG_per[[i]]$MBCdeg1$K3)))
common_mbcdeg2 <- c(common_mbcdeg2,length(intersect(disDEG_ori$MBCdeg2$K3,disDEG_per[[i]]$MBCdeg2$K3)))
common_mbcdeg3 <- c(common_mbcdeg3,length(intersect(disDEG_ori$MBCdeg3$K3,disDEG_per[[i]]$MBCdeg3$K3)))
}
# まとめる
nDEG_common <- cbind(common_edger,common_deseq2,common_tcc,
common_mbcdeg1,common_mbcdeg2,common_mbcdeg3)
colnames(nDEG_common)<-c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3")
# 確認
head(nDEG_common)
#### 棒グラフ
par(mar=c(3, 5, 2, 1))
xm <- apply(nDEG_common, 2, mean)  # 列(手法)ごとの平均
xs <- apply(nDEG_common, 2, sd)    # 列(手法)ごとの標準偏差
xm
b<- barplot(xm,
main = main,
ylim = c(0,40000), #(10000,2500,5000,40000)
xlim = c(0,7),
width = 1.0,
ylab = "of identified DEGs from\nboth original and permuted data",
xlab = "",
space = 0.1,
yaxs = "i",
col=c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"))
arrows(b, xm - xs, b, xm + xs, code = 3, lwd = 1, angle = 90, length = 0.1) # エラーバー
par(new=T)
plot(y = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3),
x = c(0.6,1.7,2.8,3.9,5.0,6.1),
ylim = c(0,40000),
xlim = c(0,7),
ylab = "",xlab = "",
xaxt="n",
pch = 2,
col="red",
yaxs = "i")# Copy Image
b<- barplot(xm,
main = main,
ylim = c(0,5000), #(10000,2500,5000,40000)
xlim = c(0,7),
width = 1.0,
ylab = "of identified DEGs from\nboth original and permuted data",
xlab = "",
space = 0.1,
yaxs = "i",
col=c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"))
arrows(b, xm - xs, b, xm + xs, code = 3, lwd = 1, angle = 90, length = 0.1) # エラーバー
par(new=T)
plot(y = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3),
x = c(0.6,1.7,2.8,3.9,5.0,6.1),
ylim = c(0,5000),
xlim = c(0,7),
ylab = "",xlab = "",
xaxt="n",
pch = 2,
col="red",
yaxs = "i")# Copy Image
x <- data.frame(Method = c("MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(#nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#FF367F","#4689FF","#009900"),labels =c("MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
g <- g + guides(fill = guide_legend(nrow=1))
plot(g)
reticulate::repl_python()
reticulate::repl_python()
setwd("~/Desktop/修論script/simdata_analysis/obtaining_results")
# Loading scripts
source("param.R")
# Loading scripts
source("../../param.R")
source("../../package.R")
# Setting parameters
G <- param$g
PDEG <- param$pdeg[[1]]
#assign <- param$assign$`2group`[[1]]
#P1 <- assign[1]
#P2 <- assign[2]
n1 <- n2 <- param$rep[[1]]
k.list <- param$k[[1]]
data.name <- param$simdata.name
name <- data.name[1]
assign <- param$assign$`2group`[[1]]
P1 <- assign[1]
P2 <- assign[2]
# Loading data
in_f <- paste("~/Desktop/res_2group_",name,"_",PDEG,"_",P1,"_n",n1,".obj",sep="")
data.all <- readRDS(in_f)
# Loading data
in_f <- paste("../res_2group_",name,"_",PDEG,"_",P1,"_n",n1,".obj",sep="")
data.all <- readRDS(in_f)
length(data.all$edgeR)
data <- list(edgeR = data.all$edgeR[51:100],
DESeq2 = data.all$DESeq2[51:100],
TCC = data.all$TCC[51:100],
MBCdeg1 = data.all$MBCdeg1$K3[51:100],
MBCdeg2 = data.all$MBCdeg2$K3[51:100],
MBCdeg3 = data.all$MBCdeg3$K3[51:100])
# 計算時間をデータフレームにする
df_ptm <- NULL
for (j in 1:length(data)){
list_ptm <- NULL
for (i in 1:length(data$edgeR)){
ptm <- data[[j]][[i]]$time
list_ptm <- rbind(list_ptm,ptm)
}
df_ptm <- cbind(df_ptm,list_ptm)
}
colnames(df_ptm) <- names(data)
# 計算時間の平均を求める
mean <- colMeans(df_ptm)
# 平均計算時間をデータフレームにまとめる
df_mean <- rbind(df_mean,mean)
df_mean <- NULL
# 平均計算時間をデータフレームにまとめる
df_mean <- rbind(df_mean,mean)
rownames(df_mean) <- param$pdeg
rownames(df_mean) <- param$pdeg[1]
rownames(df_mean) <- param$assign$`2group`[1]
df_mean
param$assign$`2group
``
param$assign$`2group`
df_mean
# Loading scripts
source("../../param.R")
source("../../package.R")
# Setting parameters
data.name <- param$realdata.name
name <- data.name[1]
k.list <- param$k[[3]]
# Loading data
in_f <- paste("../res_",name,"_ori.obj",sep="")
res.all <- readRDS(in_f)
setwd("~/Desktop/修論script/realdata_analysis/obtaining_results")
res.all <- readRDS(in_f)
res.all$edgeR[[1]]$time
length(res.all$edgeR
)
# 計算時間をデータフレームにする
df_ptm <- NULL
for (j in 1:length(res.all)){
list_ptm <- NULL
for (i in 1:length(res.all$edgeR)){
ptm <- data[[j]][[i]]$time
list_ptm <- rbind(list_ptm,ptm)
}
df_ptm <- cbind(df_ptm,list_ptm)
}
df_ptm
colnames(df_ptm) <- names(res.all)
# 計算時間の平均を求める
mean <- colMeans(df_ptm)
mean
names(res.all)
# データフレームの順番を揃える
df_mean <- data.frame(c(df_mean[,4],df_mean[,5],df_mean[,6],df_mean[,3],df_mean[,2],df_mean[,1]))
df_mean
data.frame(c(1,2,3))
# 平均計算時間をデータフレームにまとめる
df_mean <- rbind(df_mean,mean)
length(res.all$MBCdeg1)
res.all$MBCdeg1$K2
# res.allの順番をedgeR ~ MBCdeg3にする
data <- list(edgeR = res.all$edgeR,
DESeq2 = res.all$DESeq2,
TCC = res.all$TCC,
MBCdeg1_K2 = res.all$MBCdeg1$K2,
MBCdeg1_K3 = res.all$MBCdeg1$K3,
MBCdeg1_K4 = res.all$MBCdeg1$K4,
MBCdeg1_K5 = res.all$MBCdeg1$K5,
MBCdeg2_K2 = res.all$MBCdeg2$K2,
MBCdeg2_K3 = res.all$MBCdeg2$K3,
MBCdeg2_K4 = res.all$MBCdeg2$K4,
MBCdeg2_K5 = res.all$MBCdeg2$K5,
MBCdeg3_K2 = res.all$MBCdeg3$K2,
MBCdeg3_K3 = res.all$MBCdeg3$K3,
MBCdeg3_K4 = res.all$MBCdeg3$K4,
MBCdeg3_K5 = res.all$MBCdeg3$K5)
# 計算時間をデータフレームにする
df_ptm <- NULL
for (j in 1:length(data)){
list_ptm <- NULL
for (i in 1:length(data$edgeR)){
ptm <- data[[j]][[i]]$time
list_ptm <- rbind(list_ptm,ptm)
}
df_ptm <- cbind(df_ptm,list_ptm)
}
colnames(df_ptm) <- names(data)
# 計算時間の平均を求める
mean <- colMeans(df_ptm)
# 平均計算時間をデータフレームにまとめる
df_mean <- rbind(df_mean,mean)
df_mean
mean
data.name
# Loading scripts
source("../../param.R")
source("../../package.R")
# Setting parameters
data.name <- param$realdata.name
k.list <- param$k[[3]]
df_mean <- NULL
for (name in data.name[1]){
# Loading data
in_f <- paste("../res_",name,"_ori.obj",sep="")
res.all <- readRDS(in_f)
# res.allの順番をedgeR ~ MBCdeg3にする
data <- list(edgeR = res.all$edgeR,
DESeq2 = res.all$DESeq2,
TCC = res.all$TCC,
MBCdeg1_K2 = res.all$MBCdeg1$K2,
MBCdeg1_K3 = res.all$MBCdeg1$K3,
MBCdeg1_K4 = res.all$MBCdeg1$K4,
MBCdeg1_K5 = res.all$MBCdeg1$K5,
MBCdeg2_K2 = res.all$MBCdeg2$K2,
MBCdeg2_K3 = res.all$MBCdeg2$K3,
MBCdeg2_K4 = res.all$MBCdeg2$K4,
MBCdeg2_K5 = res.all$MBCdeg2$K5,
MBCdeg3_K2 = res.all$MBCdeg3$K2,
MBCdeg3_K3 = res.all$MBCdeg3$K3,
MBCdeg3_K4 = res.all$MBCdeg3$K4,
MBCdeg3_K5 = res.all$MBCdeg3$K5)
# 計算時間をデータフレームにする
df_ptm <- NULL
for (j in 1:length(data)){
list_ptm <- NULL
for (i in 1:length(data$edgeR)){
ptm <- data[[j]][[i]]$time
list_ptm <- rbind(list_ptm,ptm)
}
df_ptm <- cbind(df_ptm,list_ptm)
}
colnames(df_ptm) <- names(data)
# 計算時間の平均を求める
mean <- colMeans(df_ptm)
# 各リアルデータ解析の平均計算時間をまとめる
df_mean <- rbind(df_mean,mean)
}
# データセット名を列名にする
rownames(df_mean) <- data.name
# データセット名を列名にする
rownames(df_mean) <- data.name[1]
df_mean
