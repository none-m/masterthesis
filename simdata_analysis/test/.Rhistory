nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = method, y = nDEG, fill =c("#8a2be2","#cd853f","#696969",rep("#FF367F",1),rep("#4689FF",1),rep("#009900",1))))
g <- g + geom_bar(stat = "identity")
plot(g)
g <- g + scale_fill_nejm()
plot(g)
x
g <- ggplot(x, aes(x = method, y = nDEG, fill = method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_fill_nejm()
plot(g)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"),labels = labels)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"),labels = labels)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"),labels = labels)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + geom_bar(stat = "identity")
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"),labels = labels)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + geom_bar(stat = "identity")
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#cd853f","#8a2be2","#FF367F","#4689FF","#009900","#696969"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","dTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
#g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+ scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+ scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom')
plot(g)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, color = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_color_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))+scale_fill_manual(values=rep("white",6),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
x <- data.frame(Method = c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#FF367F","#4689FF","#009900","#696969"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank())
plot(g)
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
plot(g)
g <- g + guides(color = guide_legend(nrow=1))
plot(g)
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("dedgeR","DESeq2","fTCC","MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"),labels =c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
g <- g + guides(fill = guide_legend(nrow=1))
plot(g)
# pickrell
main = "Lymphoblastoid cell lines (Female vs. Male)"
disDEG_ori_all <- readRDS("/Users/manon/Desktop/リアルデータ解析/Pickrell/original_analysis/discoveryDEG_ori_Ntri10_p.obj")
disDEG_per <- readRDS("~/Desktop/リアルデータ解析/Pickrell/permuted_analysis/discoveryDEG_per.obj")
nDEG_per <- read.table("~/Desktop/リアルデータ解析/Pickrell/permuted_analysis/nDEG_permuted.txt",sep = "\t",header = T)
# ある1試行の検出DEG数をデータフレームにまとめる
disDEG_ori <- disDEG_ori_all[[6]] #データ順に1,9,6,1行目
nDEG_ori <- data.frame(edgeR = length(disDEG_ori$edgeR),
DESeq2 = length(disDEG_ori$DESeq2),
TCC = length(disDEG_ori$TCC),
MBCdeg1_K2 = length(disDEG_ori$MBCdeg1$K2),
MBCdeg1_K3 = length(disDEG_ori$MBCdeg1$K3),
MBCdeg1_K4 = length(disDEG_ori$MBCdeg1$K4),
MBCdeg1_K5 = length(disDEG_ori$MBCdeg1$K5),
MBCdeg2_K2 = length(disDEG_ori$MBCdeg2$K2),
MBCdeg2_K3 = length(disDEG_ori$MBCdeg2$K3),
MBCdeg2_K4 = length(disDEG_ori$MBCdeg2$K4),
MBCdeg2_K5 = length(disDEG_ori$MBCdeg2$K5),
MBCdeg3_K2 = length(disDEG_ori$MBCdeg3$K2),
MBCdeg3_K3 = length(disDEG_ori$MBCdeg3$K3),
MBCdeg3_K4 = length(disDEG_ori$MBCdeg3$K4),
MBCdeg3_K5 = length(disDEG_ori$MBCdeg3$K5))
max(nDEG_ori)
#-----------------------------------------------
# Fig. A2 オリジナルデータ(K=3)でのDEG検出数
#-----------------------------------------------
nDEG_ori_k3 <- data.frame(edgeR = nDEG_ori$edgeR,
DESeq2 = nDEG_ori$DESeq2,
TCC = nDEG_ori$TCC,
MBCdeg1 = nDEG_ori$MBCdeg1_K3,
MBCdeg2 = nDEG_ori$MBCdeg2_K3,
MBCdeg3 = nDEG_ori$MBCdeg3_K3)
deg_list <- NULL
dist <- list()
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$edgeR)
}
dist$edgeR <- table(table(deg_list))
deg_edger <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$DESeq2)
}
dist$DESeq2 <- table(table(deg_list))
deg_deseq2 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$TCC)
}
dist$TCC <- table(table(deg_list))
deg_tcc <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg1$K3)
}
dist$MBCdeg1 <- table(table(deg_list))
deg_mbcdeg1 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg2$K3)
}
dist$MBCdeg2 <- table(table(deg_list))
deg_mbcdeg2 <- deg_list
deg_list <- NULL
for (i in 1:100){
deg_list <- c(deg_list,disDEG_per[[i]]$MBCdeg3$K3)
}
dist$MBCdeg3 <- table(table(deg_list))
deg_mbcdeg3 <- deg_list
# 確認
dist
df_edgeR <- df_DESeq2 <- df_TCC <- df_MBCdeg1 <- df_MBCdeg2 <- df_MBCdeg3 <-data.frame(x = paste(1:100),
y = rep(0,100))
str(disDEG_ori)
### オリジナルデータセットと並べ替えデータセットで共通して検出されたDEGのリスト
common_edger <- NULL   # 共通検出DEGの数(K=3)
common_deseq2 <- NULL
common_tcc <- NULL
common_mbcdeg1 <- NULL
common_mbcdeg2 <- NULL
common_mbcdeg3 <- NULL
for (i in 1:100){
common_edger <- c(common_edger,length(intersect(disDEG_ori$edgeR,disDEG_per[[i]]$edgeR)))
common_deseq2 <- c(common_deseq2,length(intersect(disDEG_ori$DESeq2,disDEG_per[[i]]$DESeq2)))
common_tcc <- c(common_tcc,length(intersect(disDEG_ori$TCC,disDEG_per[[i]]$TCC)))
common_mbcdeg1 <- c(common_mbcdeg1,length(intersect(disDEG_ori$MBCdeg1$K3,disDEG_per[[i]]$MBCdeg1$K3)))
common_mbcdeg2 <- c(common_mbcdeg2,length(intersect(disDEG_ori$MBCdeg2$K3,disDEG_per[[i]]$MBCdeg2$K3)))
common_mbcdeg3 <- c(common_mbcdeg3,length(intersect(disDEG_ori$MBCdeg3$K3,disDEG_per[[i]]$MBCdeg3$K3)))
}
# まとめる
nDEG_common <- cbind(common_edger,common_deseq2,common_tcc,
common_mbcdeg1,common_mbcdeg2,common_mbcdeg3)
colnames(nDEG_common)<-c("edgeR","DESeq2","TCC","MBCdeg1","MBCdeg2","MBCdeg3")
# 確認
head(nDEG_common)
#### 棒グラフ
par(mar=c(3, 5, 2, 1))
xm <- apply(nDEG_common, 2, mean)  # 列(手法)ごとの平均
xs <- apply(nDEG_common, 2, sd)    # 列(手法)ごとの標準偏差
xm
b<- barplot(xm,
main = main,
ylim = c(0,40000), #(10000,2500,5000,40000)
xlim = c(0,7),
width = 1.0,
ylab = "of identified DEGs from\nboth original and permuted data",
xlab = "",
space = 0.1,
yaxs = "i",
col=c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"))
arrows(b, xm - xs, b, xm + xs, code = 3, lwd = 1, angle = 90, length = 0.1) # エラーバー
par(new=T)
plot(y = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3),
x = c(0.6,1.7,2.8,3.9,5.0,6.1),
ylim = c(0,40000),
xlim = c(0,7),
ylab = "",xlab = "",
xaxt="n",
pch = 2,
col="red",
yaxs = "i")# Copy Image
b<- barplot(xm,
main = main,
ylim = c(0,5000), #(10000,2500,5000,40000)
xlim = c(0,7),
width = 1.0,
ylab = "of identified DEGs from\nboth original and permuted data",
xlab = "",
space = 0.1,
yaxs = "i",
col=c("#8a2be2","#cd853f","#696969","#FF367F","#4689FF","#009900"))
arrows(b, xm - xs, b, xm + xs, code = 3, lwd = 1, angle = 90, length = 0.1) # エラーバー
par(new=T)
plot(y = c(nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3),
x = c(0.6,1.7,2.8,3.9,5.0,6.1),
ylim = c(0,5000),
xlim = c(0,7),
ylab = "",xlab = "",
xaxt="n",
pch = 2,
col="red",
yaxs = "i")# Copy Image
x <- data.frame(Method = c("MBCdeg1","MBCdeg2","MBCdeg3"),
nDEG = c(#nDEG_ori$edgeR,nDEG_ori$DESeq2,nDEG_ori$TCC,
nDEG_ori$MBCdeg1_K3,nDEG_ori$MBCdeg2_K3,nDEG_ori$MBCdeg3_K3))
g <- ggplot(x, aes(x = Method, y = nDEG, fill = Method))
g <- g + theme_bw()
g <- g + geom_bar(stat = "identity")
g <- g + scale_x_discrete(limit=c("MBCdeg1","MBCdeg2","MBCdeg3"),
labels =c("MBCdeg1","MBCdeg2","MBCdeg3"))
#g <- g + scale_fill_nejm()
g <- g + scale_fill_manual(values = c("#FF367F","#4689FF","#009900"),labels =c("MBCdeg1","MBCdeg2","MBCdeg3"))
g<- g+ theme(legend.box='horizontal',
legend.position='bottom',
panel.grid.major.x=element_blank(),
legend.title=element_text(size = 15,face = "bold"),
legend.text = element_text(size = 15,face = "bold.italic"))
g <- g + guides(fill = guide_legend(nrow=1))
plot(g)
reticulate::repl_python()
reticulate::repl_python()
proc.time()
ptm <- proc.time()
proc.time() - ptm
proc.time()
proc.time()
proc.time()
proc.time()[3]
ptm <- proc.time()
ptm <- proc.time()-ptm
ptm[3]
setwd("~/Desktop/修論script/simdata_analysis/test")
# Loading scripts
source("../../param.R")
source("../../package.R")
source("../../pipeline.R")
# Setting parameters
G <- param$g
PDEG <- param$pdeg[[1]]
assign <- param$assign$`2group`[[1]]
P1 <- assign[1]
P2 <- assign[2]
FC <- param$fc
n1 <- n2 <- param$rep[[1]]
k.list <- param$k[[1]]
q <- param$q
data.name <- param$simdata.name
name <- data.name[1]
# Loading data
in_f <- paste("../simdata_2group_",PDEG,"_",P1,"_n",n1,".obj",sep="")
data.all <- readRDS(in_f)
i=1
data <- data.all[[name]][[i]]$count
data.cl <- data.all[[name]][[i]]$group$group
obj <- as.numeric(data.all[[name]][[i]]$simulation$trueDEG != 0)
### edgeR
res.list$edgeR[[i]] <- my.edger(data,data.cl)
# DE analysis
## Preparation
res.list <- list()
### edgeR
res.list$edgeR[[i]] <- my.edger(data,data.cl)
res.list$edgeR[[i]]
res.list$edgeR[[i]]$time
res.list$edgeR[[i]]
source("../../pipeline.R")
### edgeR
res.list$edgeR[[i]] <- my.edger(data,data.cl)
source("../../pipeline.R")
### edgeR
res.list$edgeR[[i]] <- my.edger(data,data.cl)
res.list$edgeR[[i]]$time
source("../../pipeline.R")
### DESeq2
res.list$DESeq2[[i]] <- my.deseq2(data,data.cl)
res.list$DESeq2[[i]]$table
res.list$DESeq2[[i]]$time
### TCC
res.list$TCC[[i]] <- my.tcc(data,data.cl,q=q)
res.list$TCC[[i]]$time
k=1
res.list$MBCdeg1[[k]][[i]] <- my.mbcdeg(data,data.cl,k=k.list[k],q=q)
res.list$MBCdeg1 <- res.list$MBCdeg2 <- res.list$MBCdeg3 <- vector("list", length = length(k.list))
res.list$MBCdeg1[[k]][[i]] <- my.mbcdeg(data,data.cl,k=k.list[k],q=q)
res.list$MBCdeg1[[k]][[i]]$time
res.list$edgeR[[1]]$table$rank
res.list$DESeq2[[1]]$table
res.list$DESeq2[[1]]$table$rank
res.list$TCC[[1]]$table$rank
res.list$MBCdeg1[[1]][[1]]$table$rank
res.list$edgeR[[1]]$table
res.all <- res.list
### edgeR
res <- res.all$edgeR[[i]]$table
res$FDR[is.na(res$FDR)] <- 1
res
### DESeq2
res <- res.all$DESeq2[[i]]$table
res$padj[is.na(res$padj)] <- 1
